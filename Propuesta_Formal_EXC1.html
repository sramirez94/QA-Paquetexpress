<!--
  @description       : 
  @author            : ChangeMeIn@UserSettingsUnder.SFDoc
  @group             : 
  @last modified on  : 03-09-2022
  @last modified by  : ChangeMeIn@UserSettingsUnder.SFDoc
-->
<apex:page standardController="SBQQ__Quote__c" extensions="PAQ_COTResumenCotizacionEXC_CTR" renderAs="pdf" showHeader="false" sidebar="false" standardStylesheets="false" applyBodyTag="false" applyHtmlTag="false">
    <html> 
        <head> 
             
            <style type="text/css"> 
                @page { size: Legal landscape; margin: 10mm; 
                @top-center { content: " "; font-family: sans-serif; font-size: 90pt;} 
                @bottom-center { content: "Page " counter(page) " of " counter(pages); } }
                <!--table,td,th {border:0.5px solid black;}-->
                
                .page-break { display:block; page-break-after:always; } 
                
                .objetivo {
                font-family: sans-serif; font-size: 15pt; color: white;
                background-image: url({!$Resource.Diapositiva2});
                background-repeat: no-repeat;
                background-position: right;
                background-size:contain;
                display:block; 
                page-break-after:always;}
                
                .cotizacion {
                font-family: sans-serif; font-size: 15pt; color: black;
                background: url({!$Resource.Diapositiva5}) no-repeat;
                background-position:top center;
                background-size:contain;
                display:block; 
                page-break-after:always;}
                
                .tarifa {
                font-family: sans-serif; font-size: 12pt; color: black; text-align:center;
                background: url({!$Resource.Diapositiva5_2}) no-repeat;
                background-position:top center;
                background-size:contain;
                display:block; 
                page-break-after:always;}
                
                .consideraciones {
                font-family: sans-serif; font-size: 15pt; color: black; line-height: 30px;
                background: url({!$Resource.Diapositiva6}) no-repeat;
                background-position: top center;
                background-size:contain;
                display:block; 
                page-break-after:always;}
                
                .gracias {
                font-family: sans-serif; font-size: 15pt; color: black;
                background: url({!$Resource.Diapositiva7}) no-repeat;
                background-position:top center;
                background-size:contain;}
               
            </style> 
        </head> 
        <body> 
            
            <div class="page-break">
               <img src="{!URLFOR($Resource.Diapositiva1)}" width="100%" height="auto"/>
            </div> 
            
            <div class="objetivo">
                <div align="justify" style="width:500px; height:700px; position:relative; top:350px; left: 650px">
                    Establecer una sociedad comercial entre {!SBQQ__Quote__c.SBQQ__Account__r.Name}
                	y PAQUETEXPRESS® ofreciendo el portafolio de
                	servicios con soluciones logísticas integrales
                	garantizando el cumplimiento de sus expectativas de
                	promesa de entrega, con cercanía y ayuda mutua. 
                    </div>
            </div> 
            
            <div class="page-break">
               <img src="{!URLFOR($Resource.Diapositiva3)}" width="100%" height="auto"/>
            </div>  
            <div class="page-break">
               <img src="{!URLFOR($Resource.Diapositiva4)}" width="100%" height="auto"/>
            </div>
            
      		<!-- COSTO BASE MÁS EXCEDENTE -->
            
            <apex:outputPanel >
            <div class="tarifa">
                <div style= "width: 850px; height:700px; position:relative; top: 145px">
                    <br />
                    <table align="center" style="border-collapse: collapse;" border="solid 0.5px">
                		<tr style="height: 2px"></tr>
                			<td colspan="30" align="Center" style="font-size:12px; padding:0px 35px 0px 35px; background-color:rgb(31, 73, 125); color: white;"></td>
                				<apex:repeat value="{!mapBlocks}" var="nameBlock">
                    				<td colspan="30" align="Center" style="font-size:12px; padding:0px 35px 0px 35px; background-color:rgb(31, 73, 125); color: white;">{!nameBlock}</td>
                				</apex:repeat>
                			<td colspan="30" align="Center" style="font-size:12px; padding:0px 35px 0px 35px; background-color:rgb(31, 73, 125); color: white;">EXCEDENTE</td>
                        	<apex:outputText rendered="{!T7ZP}">
                        		<td colspan="30" align="Center" style="font-size:12px; padding:0px 35px 0px 35px; background-color:rgb(31, 73, 125); color: white;">Zona Plus T7</td>
                        	</apex:outputText>
                		<tr>
                    		<td colspan="30" align="Center" style="font-size:12px; padding:0px 35px 0px 35px; background-color:rgb(31, 73, 125); color: white;">Peso báscula Kg</td>
                    			<apex:repeat value="{!mapBlocks}" var="nameBlock">
                        			<td colspan="30" align="Center" style="font-size:12px; padding:0px 35px 0px 35px; background-color:rgb(31, 73, 125); color: white;">{!mapBlocks[nameBlock].decWeight}</td>
                    			</apex:repeat>
                    		<td colspan="30" align="Center" style="font-size:12px; padding:0px 35px 0px 35px; background-color:rgb(31, 73, 125); color: white;">1.000</td>
                            <apex:outputText rendered="{!T7ZP}">
                        		<td colspan="30" align="Center" style="font-size:12px; padding:0px 35px 0px 35px; background-color:rgb(31, 73, 125); color: white;">
                                    <apex:outputText value="{0, number, ###,###,##0.00}" rendered="true">
                                        <apex:param value="{!elPeso}" />
                                    </apex:outputText>
                                </td>
                        	</apex:outputText>
                		</tr>
                		<tr>
                    		<td colspan="30" align="Center" style="font-size:12px; padding:0px 35px 0px 35px; background-color:rgb(31, 73, 125); color: white;">Volumen m3</td>
                    			<apex:repeat value="{!mapBlocks}" var="nameBlock">
                        			<td colspan="30" align="Center" style="font-size:12px; padding:0px 35px 0px 35px; background-color:rgb(31, 73, 125); color: white;">{!mapBlocks[nameBlock].decVol}</td>
                    			</apex:repeat>
                    		<td colspan="30" align="Center" style="font-size:12px; padding:0px 35px 0px 35px; background-color:rgb(31, 73, 125); color: white;">0.005</td>
                            <apex:outputText rendered="{!T7ZP}">
                        		<td colspan="30" align="Center" style="font-size:12px; padding:0px 35px 0px 35px; background-color:rgb(31, 73, 125); color: white;">---</td>
                        	</apex:outputText>
                		</tr>
                		<tr>
                    		<td colspan="30" align="Center" style="font-size:12px; padding:0px 35px 0px 35px; background-color:rgb(31, 73, 125); color: white;">Kg volumétrico</td>
                    			<apex:repeat value="{!mapBlocks}" var="nameBlock">
                        			<td colspan="30" align="Center" style="font-size:12px; padding:0px 35px 0px 35px; background-color:rgb(31, 73, 125); color: white;">{!mapBlocks[nameBlock].decVolWeight}</td>
                    			</apex:repeat>
                    		<td colspan="30" align="Center" style="font-size:12px; padding:0px 35px 0px 35px; background-color:rgb(31, 73, 125); color: white;">1.000</td>
                            <apex:outputText rendered="{!T7ZP}">
                                <td colspan="30" align="Center" style="font-size:12px; padding:0px 35px 0px 35px; background-color:rgb(31, 73, 125); color: white;">
                                    <apex:outputText value="{0, number, ###,###,##0.000}" rendered="true">
                                        <apex:param value="{!elVol}" />
                                    </apex:outputText></td>
                        	</apex:outputText>
                		</tr>
            		</table>
                    <br /><br />
                <table align="center" style="border-collapse: collapse;" border="solid 0.5px">
                 <tr>
                	<td colspan="30" rowspan ="2" align="Center" style="font-size:12px; padding:0px 10px 0px 10px; background-color:rgb(31, 73, 125); color: white;">Rango Km</td>
                    <apex:repeat value="{!mapBlocks}" var="nameBlock">
                        <td colspan="30" align="Center" style="font-size:12px; padding:0px 10px 0px 10px; background-color:rgb(31, 73, 125); color: white;">{!nameBlock}</td>
                    </apex:repeat>
                	<td colspan="30" rowspan ="2" align="Center" style="font-size:12px; padding:0px 10px 0px 10px; background-color:rgb(31, 73, 125); color: white;">Kg Adicional</td>
                    <apex:outputText rendered="{!blnACK}">
                    	<td colspan="30" rowspan ="2" align="Center" style="font-size:12px; padding:0px 10px 0px 10px; background-color:rgb(31, 73, 125); color: white;">Acuse</td>
                	</apex:outputText>
                	<apex:outputText rendered="{!blnZP}">
                    	<td colspan="30" rowspan ="2" align="Center" style="font-size:12px; padding:0px 10px 0px 10px; background-color:rgb(31, 73, 125); color: white;">Zona plus</td>
                	</apex:outputText>
                    <apex:outputText rendered="{!T7ZP}">
                    	<td colspan="30" rowspan ="2" align="Center" style="font-size:12px; padding:0px 10px 0px 10px; background-color:rgb(31, 73, 125); color: white;">Zona plus T7</td>
                	</apex:outputText>
                </tr>
                <tr>
                    <apex:repeat value="{!mapBlocks}" var="nameBlock">
                        <td colspan="30" align="Center" style="font-size:12px; padding:0px 5px 0px 5px; background-color:rgb(31, 73, 125); color: white;">Tarifa propuesta</td>
                    </apex:repeat>
                </tr>
                <apex:repeat value="{!listRangeDestiny}" var="strRange">
                    <tr>
                        <td colspan="30" align="left" style="font-size:12px; padding:0px 5px 0px 5px;">{!strRange}</td>
                        <apex:repeat value="{!mapBlocks}" var="nameBlock">
                            <td colspan="30" align="Center" style="font-size:12px; padding:0px 5px 0px 5px;">
                                <apex:outputText value="{0, number, $ ###,###,##0.00}">
                                    <apex:param value="{!mapBlocks[nameBlock].mapRanges[strRange]}" />
                                </apex:outputText>
                            </td>
                        </apex:repeat>
                        <td colspan="30" align="Center" style="font-size:12px; padding:0px 5px 0px 5px;">
                            <apex:outputText value="{0, number, $ ###,###,##0.00}">
                                <apex:param value="{!mapService['ADD'].mapRanges[strRange]}" />
                            </apex:outputText>
                        </td>
                        <apex:outputText rendered="{!blnACK}">
                                <td colspan="30" align="Center" style="font-size:12px; padding:0px 5px 0px 5px;">
                                    <apex:outputText value="{0, number, $ ###,###,##0.00}" rendered="{!blnACK}">
                                        <apex:param value="{!mapService['ACK'].mapRanges[strRange]}" />
                                    </apex:outputText>
                                </td>
                            </apex:outputText>
                            <apex:outputText rendered="{!blnZP}">
                                <td colspan="30" align="Center" style="font-size:12px; padding:0px 5px 0px 5px;">
                                    <apex:outputText value="{0, number, $ ###,###,##0.00}" rendered="{!blnZP}">
                                        <apex:param value="{!mapService['ZP'].mapRanges[strRange]}" />
                                    </apex:outputText>
                                </td>
                            </apex:outputText>
                        	<apex:outputText rendered="{!T7ZP}">
                                <td colspan="30" align="Center" style="font-size:12px; padding:0px 5px 0px 5px;">
                                    <apex:outputText value="{0, number, $ ###,###,##0.00}" rendered="{!T7ZP}">
                                        <apex:param value="{!mapPropuestaT7ZP[strRange].SBQQ__SpecialPrice__c}" />
                                    </apex:outputText>
                                </td>
                            </apex:outputText>
                    </tr>
                </apex:repeat>
            </table>
            
            	</div>
                </div>
            </apex:outputPanel>
            
            <div class="tarifa">
             <div style="width: 350px; height:550px; position:absolute; top: 3150px; left: 900px; text-align: left">
                    <ul>
                        <li>Convenio: {!wp.objQuote.Tipo_de_documentacion__c}</li>
                        <li>Servicio: {!wp.objQuote.PAQ_TipoServicio__c}</li>
                        <li>Destinos: Nacionales</li>
                        <li><apex:outputText rendered="{!wp.objQuote.Servicios_adicionales__c != null}">
                            Servicios adicionales que incluye:
                            </apex:outputText>
                    <ul>
                    <apex:outputText rendered="{!CONTAINS(wp.objQuote.Servicios_adicionales__c,'RAD')=true}">
                      <li>Recolección a domicilio</li>
                    </apex:outputText>
                    <apex:outputText rendered="{!CONTAINS(wp.objQuote.Servicios_adicionales__c,'EAD')=true}">
                      <li>Entrega a domicilio</li>
                    </apex:outputText>
                    <apex:outputText rendered="{!blnZP}">
                      <li>Zona plus</li>
                    </apex:outputText>
                    <apex:outputText rendered="{!CONTAINS(wp.objQuote.Servicios_adicionales__c,'Seguro')=true}">
                      <li>Seguro</li>
                    </apex:outputText>
                    <apex:outputText rendered="{!wp.objQuote.Acuse__c != null}">
                      <li>Acuse {!wp.objQuote.Acuse__c}</li>
                    </apex:outputText>
                    <apex:outputText rendered="{!T7ZP}">
                      <li>Zona Plus para Tarimas</li>
                    </apex:outputText>
                    </ul>
                    </li>
                        <li>Tarifas antes de impuestos</li>
                        <li>Tarifas se cobran por bulto documentado</li>
                        <li>Vigencia al 31 de diciembre del {!YEAR(TODAY())}</li>
                        <li>Servicios, tarifas y destinos no cotizados, serán cobrados  al costo de tarifario de piso, sin descuentos</li>
                        <li><apex:outputText rendered="{!IF(wp.objQuote.Servicios_adicionales__c != null && (CONTAINS(wp.objQuote.Servicios_adicionales__c,'RAD')=false || CONTAINS(wp.objQuote.Servicios_adicionales__c,'EAD')=false || CONTAINS(wp.objQuote.Servicios_adicionales__c,'EAD Zona plus')=false || CONTAINS(wp.objQuote.Servicios_adicionales__c,'Seguro')=false || wp.objQuote.Acuse__c == null),true,false)}">
                            Servicios opcionales no incluidos: 
                    <ul>
                    <apex:outputText rendered="{!CONTAINS(wp.objQuote.Servicios_adicionales__c,'RAD')=false}">
                      <li>Recolección a domicilio $103.50 en ciudades macro, $83.50 en ciudades grandes y $74.87 en ciudades chicas y medianas
                      </li>
                    </apex:outputText>
                    <apex:outputText rendered="{!CONTAINS(wp.objQuote.Servicios_adicionales__c,'EAD')=false}">
                      <li>Entrega a domicilio $103.50 en ciudades macro, $83.50 en ciudades grandes y $74.87 en ciudades chicas y medianas
                      </li>
                    </apex:outputText>
                    <apex:outputText rendered="{!CONTAINS(wp.objQuote.Servicios_adicionales__c,'EAD Zona plus')=false}">
                      <li>Entrega en Zona plus $241.01 más IVA por paquete (Aplica en Tarifas no mayores a T6)
                      </li>
                    </apex:outputText>
                    <apex:outputText rendered="{!CONTAINS(wp.objQuote.Servicios_adicionales__c,'Seguro')=false}">
                      <li> Seguro $12.00 más IVA por cada $1,000.00 de valor declarado
                      </li>
                    </apex:outputText>
                    <apex:outputText rendered="{!wp.objQuote.Acuse__c == null}">
                    <li>Acuse $74.87 más IVA
                    </li>
                    </apex:outputText>
                    </ul>
                    </apex:outputText>
                    </li>
                    </ul>

                    <li><apex:outputText rendered="{!wp.objQuote.Servicios_adicionales__c == null}">
                            Servicios opcionales no incluidos:
                        <ul>
                            <li>Recolección a domicilio $103.50 en ciudades macro, $83.50 en ciudades grandes y $74.87 en ciudades chicas y medianas</li>
                            <li>Entrega a domicilio $103.50 en ciudades macro, $83.50 en ciudades grandes y $74.87 en ciudades chicas y medianas</li>
                        	<li>Entrega en Zona plus $241.01 más IVA por paquete</li>
                            <li>Seguro $12.00 más IVA por cada $1,000.00 de valor declarado</li>
                            <li>Acuse $74.87 más IVA</li>
                        </ul>
                        </apex:outputText>
                    </li>
                </div>
            </div>
            
         
            <!-- AQUÍ EMPIEZA EL BLOQUE DE CONSIDERACIONES ESPECIALES-->
            
            <apex:outputPanel rendered="{!IF(ISBLANK(wp.objOpp.Consideraciones_especiales__c)=false,true,false)}">
            <div class="consideraciones">
                <div align="justify" style="width: 650px; height: 700px; position:relative; top: 150px; left:550px">
                	<apex:outputField value="{!wp.objOpp.Consideraciones_especiales__c}" />
                </div>
            </div> 
            </apex:outputPanel>  
               
            <div class="gracias">
                <div style= "width: 300px; height:720px; position:relative; left: 675px; text-align:center">
                    <br/><br/><br/><br/><br/><br/><br/>
                    <br/><br/><br/><br/><br/><br/><br/>
                    <br/><br/><br/><br/><br/><br/>  
                    {! $User.FirstName & ' ' & $User.LastName }
                </div>    
            </div> 
        </body> 
    </html> 
</apex:page>
